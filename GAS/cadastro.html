<!DOCTYPE html>
<html lang="pt-BR">
<head>
	<title>Cadastro de Clientes</title>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, interactive-widget=resizes-content">

	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

	<style>
		* {
			box-sizing: border-box;
			margin: 0;
		}
		button {
			margin: 0;
			border: 0;
		}
		body {
			font-family: "Roboto Condensed", sans-serif;
			font-size: 16px;
			background: #DDDDDD;
		}
		main {
			max-width: 400px;
			margin: 0 auto;
			padding: 50px 35px 150px 35px;
		}
		h1,
		h2 {
			font-weight: normal;
			text-transform: uppercase;
		}
		h1 {
			font-size: 1.5rem;
			margin-bottom: 35px;
		}
		h2 {
			font-size: 1.1rem;
		}
		.dependentesContainer > h2 {
			margin: 50px 0 25px 0;
		}
		input,
		select {
			width: 100%;
			height: 40px;
			border: 1px solid #999999;
			padding: 7px;
			font-size: 1.2rem;
			background: none;
		}
		.label {
			display: block;
			margin-top: 20px;
			font-size: 0.9rem;
			color: #8C8C8C;
		}
		.hidden {
			display: none;
		}
		.btn {
			height: 42px;
			margin: 20px 0 0 0;
			border: 1px solid #999999;
			cursor: pointer;
			font-size: 0.9rem;
			font-weight: normal;
			text-transform: uppercase;
		}
		.btn-cadastrar {
			width: 100%;
			margin-top: 30px;
		}
		.btn-dependente {
			width: 49%;
		}
		.btn-remover-dependente {
			height: 25px;
			cursor: pointer;
			background: none;
		}
		.dependente-group {
			margin-top: 20px;
		}
		.dependente-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			height: 42px;
		}
		.validation-feedback {
			margin-top: 5px;
			font-size: 0.9rem;
			color: red;
		}
		.cadastro-concluido p {
			font-size: 1.2rem;
			margin-bottom: 25px;
		}
		.info {
			margin-top: 15px;
			color: #666666;
		}
		.loading {
			display: none;
		}
	</style>
</head>
<body>
	<main>
		<h1>Cadastro</h1>
		<form id="cadastroForm" class="" data-group="titular">

			<fieldset class="hidden">
				<input type="hidden" id="csrfToken" name="csrfToken" data-key="csrfToken">
				<input type="hidden" id="cliente_id" name="cliente_id" data-key="cliente_id">
				<input type="hidden" id="timestamp" name="timestamp" data-key="timestamp">
				<input type="hidden" id="status" name="status" data-key="status" value="Ativo">
				<input type="hidden" id="cliente_desde" name="cliente_desde" data-key="cliente_desde">
				<input type="hidden" id="grupo_id" name="grupo_id" data-key="grupo_id">
				<input type="hidden" id="tipo" name="tipo" data-key="tipo" value="Titular">
				<input type="hidden" id="nome_index" name="nome_index" data-key="nome_index">
			</fieldset>

			<label for="nome" class="label">nome completo</label>
			<input id="nome" name="nome" type="text" minlength="5" maxlength="50" data-key="nome" required>
			<div id="nome-feedback" class="validation-feedback"></div>

			<label for="cpf" class="label">CPF</label>
			<input id="cpf" name="cpf" type="text" inputmode="numeric" maxlength="14" data-key="cpf" required>
			<div id="cpf-feedback" class="validation-feedback"></div>

			<label for="telefone" class="label">telefone</label>
			<input id="telefone" name="telefone" type="tel" inputmode="numeric" maxlength="15" data-key="telefone" required>
			<div id="telefone-feedback" class="validation-feedback"></div>

			<label for="cep" class="label">CEP</label>
			<input id="cep" name="cep" type="text" inputmode="numeric" maxlength="9" data-key="cep" required>
			<div id="cep-feedback" class="validation-feedback"></div>

			<label for="regiao" class="label hidden">região</label>
			<input id="regiao" name="regiao" type="text" data-key="regiao">
			<!-- preenchido pelo JS usando o CEP -->

			<label for="bairro" class="label hidden">bairro</label>
			<input id="bairro" name="bairro" type="text" data-key="bairro">
			<!-- preenchido pelo JS usando o CEP -->

			<button type="button" class="btn btn-cadastrar" id="btnSalvar" disabled>Cadastrar</button>
			<p class="info">Você pode adicionar dependentes ao seu cadastro na tela seguinte.</p>
			<div id="loading-message" class="loading">Enviando cadastro...</div>
		</form>

		<div class="dependentes hidden" id="dependentesContainer">
			<div class="dependentes-opcional">
				<h2>Deseja adicionar dependente?</h2>
				<button class="btn btn-dependente" type="button" id="btn-cadastro-concluido">Não</button>
				<button class="btn btn-dependente" type="button" id="btnAddDependente">Adicionar +</button>
			</div>

			<template id="dependenteTemplate">
				<div class="dependente-template" data-dependente-id="[IDX]" data-type="dependente" data-dependente-idx="[IDX]" data-group="dependente">
					<div class="dependente-header">
						<h2>Dependente <span class="dependente-numero">[IDX]</span></h2>
						<button type="button" class="btn-remover-dependente">remover</button>
					</div>

					<div class="hidden">
						<input type="hidden" id="cliente_id_[IDX]" name="dependentes[[IDX]][cliente_id]" data-key="cliente_id" data-type="dependente" data-dependente-idx="[IDX]">
						<input type="hidden" id="timestamp_[IDX]" name="dependentes[[IDX]][timestamp]" data-key="timestamp" data-type="dependente" data-dependente-idx="[IDX]">
						<input type="hidden" id="status_[IDX]" name="dependentes[[IDX]][status]" data-key="status" value="Ativo">
						<input type="hidden" id="cliente_desde_[IDX]" name="dependentes[[IDX]][cliente_desde]" data-key="cliente_desde" data-type="dependente" data-dependente-idx="[IDX]">
						<input type="hidden" id="grupo_id_[IDX]" name="dependentes[[IDX]][grupo_id]" data-key="grupo_id" data-type="dependente" data-dependente-idx="[IDX]">
						<input type="hidden" id="tipo_[IDX]" name="dependentes[[IDX]][tipo]" data-key="tipo" data-type="dependente" data-dependente-idx="[IDX]" value="Dependente" >
						<input type="hidden" id="nome_index_[IDX]" name="dependentes[[IDX]][nome_index]" data-key="nome_index" data-type="dependente" data-dependente-idx="[IDX]">
					</div>

					<label for="nomeDependente_[IDX]" class="label">nome</label>
					<input type="text" id="nomeDependente_[IDX]" name="dependentes[[IDX]][nome]" minlength="5" data-key="nome-dependente" required>
					<div class="validation-feedback nome-dependente-feedback"></div>
				</div>
			</template>

			<button type="button" class="btn btn-cadastrar" id="btnSalvarDependentes" disabled>Cadastrar</button>
		</div>

		<div class="cadastro-concluido hidden">
			<p>Seu cadastro foi concluído.</p>
			<p>Por favor, dirija-se ao balcão para prosseguir com seu atendimento.</p>
			<p>Obrigado!</p>
		</div>
	</main>

	<script src="GIT-Cadastro.js"></script>
</body>
</html>
